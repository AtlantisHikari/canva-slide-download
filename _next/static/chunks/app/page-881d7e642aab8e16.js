(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5782:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>M});var a=s(5155),r=s(2115),l=s(1788),i=s(7434),n=s(8164),d=s(1154),o=s(646),c=s(5339);function x(e){let t,{onUrlSubmit:i,isLoading:x=!1,error:u}=e,[h,g]=(0,r.useState)(""),[p,b]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null);(0,r.useEffect)(()=>{j(!0)},[]);let N=async e=>{if(!e.trim())return void w(null);b(!0);try{let t;if(!m(e))return void w({isValid:!1,message:"請輸入有效的 Canva 設計連結"});let a=window.location.pathname.includes("/canva-slide-download")?"/canva-slide-download":"";try{let s=await fetch("".concat(a,"/api/parse"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(s.ok)t=await s.json();else throw Error("API not available")}catch(r){let{parseCanvaUrl:a}=await s.e(272).then(s.bind(s,8272));t=await a(e)}t.valid?w({isValid:!0,message:"找到 ".concat(t.slideCount," 頁簡報: ").concat(t.title),designInfo:t}):w({isValid:!1,message:t.error||"無法訪問此 Canva 設計"})}catch(e){w({isValid:!1,message:"網路錯誤，請檢查連接後重試"})}finally{b(!1)}},y=e=>{g(e),t&&clearTimeout(t),t=setTimeout(()=>{N(e)},1e3)},k=async()=>{try{let e=await navigator.clipboard.readText();e&&m(e)&&(g(e),y(e))}catch(e){console.error("Failed to read clipboard:",e)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),h.trim()&&((null==v?void 0:v.isValid)?i(h.trim()):N(h.trim()))},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,a.jsx)(n.A,{className:"h-6 w-6 text-gray-400 group-focus-within:text-blue-500 transition-colors"})}),(0,a.jsx)("input",{type:"url",value:h,onChange:e=>y(e.target.value),placeholder:"貼上您的 Canva 簡報連結 (例：https://www.canva.com/design/xxxxx/view)",className:"w-full pl-14 pr-24 py-4 text-lg border-2 border-gray-200 rounded-2xl bg-white/70 backdrop-blur-sm focus:ring-4 focus:ring-blue-200 focus:border-blue-400 focus:bg-white transition-all duration-300 placeholder-gray-400",disabled:x}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center gap-2",children:f&&navigator.clipboard&&(0,a.jsx)("button",{type:"button",onClick:k,className:"px-4 py-2 text-sm bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-xl hover:shadow-lg transform hover:scale-105 transition-all duration-200 font-medium",disabled:x,children:"\uD83D\uDCCB 貼上"})})]}),(p||v)&&(0,a.jsx)("div",{className:"flex items-center gap-3 p-4 rounded-2xl border transition-all duration-300 ".concat(p?"bg-blue-50 border-blue-200":(null==v?void 0:v.isValid)?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.A,{className:"w-5 h-5 animate-spin text-blue-600"}),(0,a.jsx)("div",{className:"absolute inset-0 w-5 h-5 border-2 border-blue-200 rounded-full animate-pulse"})]}),(0,a.jsx)("span",{className:"text-blue-700 font-medium",children:"\uD83D\uDD0D 正在分析您的 Canva 設計..."})]}):(null==v?void 0:v.isValid)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(o.A,{className:"w-5 h-5 text-green-600"}),(0,a.jsx)("div",{className:"absolute -inset-1 bg-green-200 rounded-full animate-ping opacity-20"})]}),(0,a.jsxs)("span",{className:"text-green-700 font-medium",children:["✅ ",v.message]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"w-5 h-5 text-red-600"}),(0,a.jsxs)("span",{className:"text-red-700 font-medium",children:["❌ ",null==v?void 0:v.message]})]})}),u&&(0,a.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-2xl shadow-sm",children:[(0,a.jsx)(c.A,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-red-700 font-medium",children:u})]}),(0,a.jsx)("button",{type:"submit",disabled:x||!h.trim()||!(null==v?void 0:v.isValid),className:"w-full py-4 px-6 rounded-2xl font-bold text-lg flex items-center justify-center gap-3 transition-all duration-300 transform ".concat(!x&&h.trim()&&(null==v?void 0:v.isValid)?"bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 text-white hover:shadow-xl hover:shadow-blue-500/25 hover:scale-105 active:scale-95":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"w-6 h-6 animate-spin"}),(0,a.jsx)("span",{children:"\uD83D\uDE80 處理中..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.A,{className:"w-6 h-6"}),(0,a.jsx)("span",{children:"✨ 開始神奇下載"})]})})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-100 rounded-2xl p-6 shadow-inner",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"\uD83D\uDCA1"})}),(0,a.jsx)("h4",{className:"text-lg font-bold text-gray-800",children:"使用指南"})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,a.jsx)("span",{className:"text-white text-xs font-bold",children:"1"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-700 mb-1",children:"支援格式"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"canva.com/design/xxxxx"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,a.jsx)("span",{className:"text-white text-xs font-bold",children:"2"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-700 mb-1",children:"公開分享"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"確保設計可公開訪問"})]})]}),(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,a.jsx)("span",{className:"text-white text-xs font-bold",children:"3"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-gray-700 mb-1",children:"多頁支援"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"自動整合為單一檔案"})]})]})]})]})]})}function m(e){try{let t=new URL(e);return("www.canva.com"===t.hostname||"canva.com"===t.hostname)&&t.pathname.includes("/design/")}catch(e){return!1}}var u=s(9137),h=s.n(u),g=s(7213),p=s(381);function b(e){let{options:t,onChange:s,disabled:l=!1}=e,[n,d]=(0,r.useState)(!1),o=e=>{s({...t,...e})},c=[{value:"pdf",label:"PDF 檔案",description:"適合分享和列印",icon:i.A},{value:"images",label:"圖片壓縮包",description:"包含所有頁面的PNG圖片",icon:g.A}];return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-bold",children:"⚡"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"選擇品質"})]}),(0,a.jsx)("div",{className:"grid gap-4",children:[{value:"medium",label:"標準品質",description:"1920\xd71080, 適合大多數使用"},{value:"high",label:"高品質",description:"2560\xd71440, 推薦選擇"},{value:"ultra",label:"超高品質",description:"3840\xd72160, 最佳列印效果"}].map(e=>(0,a.jsxs)("label",{className:"group relative flex items-start p-6 border-2 rounded-2xl cursor-pointer transition-all duration-300 hover:shadow-lg ".concat(t.quality===e.value?"border-purple-400 bg-gradient-to-r from-purple-50 to-pink-50 shadow-lg ring-4 ring-purple-100":"border-gray-200 bg-white/70 backdrop-blur-sm hover:border-purple-300 hover:bg-gradient-to-r hover:from-purple-50/50 hover:to-pink-50/50"," ").concat(l?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-full border-2 mr-4 mt-1 flex items-center justify-center transition-all duration-300 ".concat(t.quality===e.value?"border-purple-500 bg-purple-500":"border-gray-300 group-hover:border-purple-400"),children:t.quality===e.value&&(0,a.jsx)("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"})}),(0,a.jsx)("input",{type:"radio",name:"quality",value:e.value,checked:t.quality===e.value,onChange:e=>o({quality:e.target.value}),disabled:l,className:"sr-only"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-bold text-lg text-gray-800 mb-1",children:e.label}),(0,a.jsx)("div",{className:"text-gray-600",children:e.description})]}),t.quality===e.value&&(0,a.jsx)("div",{className:"absolute top-4 right-4",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"✨"})})})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-bold",children:"\uD83D\uDCC1"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"選擇格式"})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:c.map(e=>(0,a.jsxs)("label",{className:"group relative flex flex-col p-6 border-2 rounded-2xl cursor-pointer transition-all duration-300 hover:shadow-xl ".concat(t.format===e.value?"border-blue-400 bg-gradient-to-br from-blue-50 to-cyan-50 shadow-xl ring-4 ring-blue-100 transform scale-105":"border-gray-200 bg-white/80 backdrop-blur-sm hover:border-blue-300 hover:bg-gradient-to-br hover:from-blue-50/50 hover:to-cyan-50/50 hover:transform hover:scale-102"," ").concat(l?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)("div",{className:"w-5 h-5 rounded-full border-2 mb-4 self-end transition-all duration-300 ".concat(t.format===e.value?"border-blue-500 bg-blue-500":"border-gray-300 group-hover:border-blue-400"),children:t.format===e.value&&(0,a.jsx)("div",{className:"w-full h-full bg-white rounded-full flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"})})}),(0,a.jsx)("input",{type:"radio",name:"format",value:e.value,checked:t.format===e.value,onChange:e=>o({format:e.target.value}),disabled:l,className:"sr-only"}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center transition-all duration-300 ".concat(t.format===e.value?"bg-gradient-to-r from-blue-500 to-cyan-600 shadow-lg":"bg-gradient-to-r from-gray-400 to-gray-500 group-hover:from-blue-400 group-hover:to-cyan-500"),children:(0,a.jsx)(e.icon,{className:"w-8 h-8 text-white"})}),(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 font-bold text-lg text-gray-800 mb-2",children:[e.label,"pdf"===e.value&&(0,a.jsx)("span",{className:"text-xs bg-gradient-to-r from-green-500 to-emerald-600 text-white px-3 py-1 rounded-full font-bold shadow-sm",children:"推薦"})]}),(0,a.jsx)("div",{className:"text-gray-600 text-sm",children:e.description})]}),t.format===e.value&&(0,a.jsx)("div",{className:"absolute -top-3 -right-3",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-600 rounded-full flex items-center justify-center shadow-lg",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"✨"})})})]},e.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{type:"button",onClick:()=>d(!n),className:"group flex items-center gap-3 text-lg font-semibold text-gray-700 hover:text-purple-600 transition-colors duration-300",disabled:l,children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-gray-400 to-gray-500 group-hover:from-purple-500 group-hover:to-pink-600 rounded-xl flex items-center justify-center transition-all duration-300",children:(0,a.jsx)(p.A,{className:"w-4 h-4 text-white"})}),"進階設定",(0,a.jsx)("span",{className:"transform transition-all duration-300 ".concat(n?"rotate-180 text-purple-600":""),children:"⬇️"})]}),n&&(0,a.jsxs)("div",{className:"mt-6 space-y-6 p-6 bg-gradient-to-br from-gray-50 to-blue-50 border-2 border-gray-200 rounded-2xl shadow-inner",children:[(0,a.jsxs)("label",{className:"group flex items-center gap-4 p-4 bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200 hover:border-purple-300 cursor-pointer transition-all duration-300",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all duration-300 ".concat(t.includeMetadata?"border-purple-500 bg-purple-500":"border-gray-300 group-hover:border-purple-400"),children:t.includeMetadata&&(0,a.jsx)("span",{className:"text-white text-sm",children:"✓"})}),(0,a.jsx)("input",{type:"checkbox",checked:t.includeMetadata,onChange:e=>o({includeMetadata:e.target.checked}),disabled:l,className:"sr-only"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-bold text-gray-800 mb-1",children:"包含檔案資訊"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"在 PDF 中包含標題、建立時間等資訊"})]})]}),(0,a.jsxs)("div",{className:"p-4 bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200",children:[(0,a.jsxs)("label",{className:"block text-lg font-bold text-gray-800 mb-4",children:["壓縮程度: ",(0,a.jsxs)("span",{className:"text-purple-600",children:[t.compression,"%"]})]}),(0,a.jsxs)("div",{className:"jsx-6deb9156599d22f6 relative",children:[(0,a.jsx)("input",{type:"range",min:"50",max:"100",step:"5",value:t.compression,onChange:e=>o({compression:parseInt(e.target.value)}),disabled:l,style:{background:"linear-gradient(to right, #fecaca 0%, #fde047 50%, #bbf7d0 100%)"},className:"jsx-6deb9156599d22f6 w-full h-3 bg-gradient-to-r from-red-200 via-yellow-200 to-green-200 rounded-lg appearance-none cursor-pointer slider"}),(0,a.jsx)(h(),{id:"6deb9156599d22f6",children:".slider.jsx-6deb9156599d22f6::-webkit-slider-thumb{appearance:none;width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,#8b5cf6,#a855f7);cursor:pointer;box-shadow:0 4px 12px rgba(139,92,246,.4);border:2px solid white}.slider.jsx-6deb9156599d22f6::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:linear-gradient(135deg,#8b5cf6,#a855f7);cursor:pointer;box-shadow:0 4px 12px rgba(139,92,246,.4);border:2px solid white}"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-medium text-gray-600 mt-3",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"w-3 h-3 bg-red-400 rounded-full"}),"小檔案"]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:["高品質",(0,a.jsx)("span",{className:"w-3 h-3 bg-green-400 rounded-full"})]})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"⏱️"})}),(0,a.jsx)("h4",{className:"text-lg font-bold text-gray-800",children:"處理時間預估"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3 p-4 bg-white/70 backdrop-blur-sm rounded-xl border border-blue-100",children:(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("p",{className:"text-gray-700 font-medium",children:["根據選擇的品質，每頁約需 ",(0,a.jsx)("span",{className:"text-blue-600 font-bold",children:"ultra"===t.quality?"10-15":"high"===t.quality?"5-8":"3-5"})," 秒處理時間"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("div",{className:"flex gap-1",children:[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(s<("ultra"===t.quality?3:"high"===t.quality?2:1)?"bg-blue-500":"bg-gray-300"," animate-pulse"),style:{animationDelay:"".concat(.2*s,"s")}},s))}),(0,a.jsx)("span",{className:"text-xs text-gray-600 font-medium",children:"ultra"===t.quality?"最高品質":"high"===t.quality?"高品質":"標準品質"})]})]})})]})]})}var f=s(4416);function j(e){let{progress:t,onCancel:s}=e,r=()=>0===t.totalPages?0:Math.round(t.currentPage/t.totalPages*100);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg ".concat("complete"===t.status?"bg-gradient-to-r from-green-500 to-emerald-600":"error"===t.status?"bg-gradient-to-r from-red-500 to-pink-600":"bg-gradient-to-r from-blue-500 to-indigo-600"),children:"complete"===t.status?(0,a.jsx)(o.A,{className:"w-7 h-7 text-white"}):"error"===t.status?(0,a.jsx)(c.A,{className:"w-7 h-7 text-white"}):(0,a.jsx)(d.A,{className:"w-7 h-7 animate-spin text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xl font-bold mb-1 ".concat("complete"===t.status?"text-green-700":"error"===t.status?"text-red-700":"text-blue-700"),children:t.message}),t.totalPages>0&&(0,a.jsxs)("div",{className:"text-gray-600 font-medium",children:["第 ",(0,a.jsx)("span",{className:"text-purple-600 font-bold",children:t.currentPage})," / ",(0,a.jsx)("span",{className:"text-purple-600 font-bold",children:t.totalPages})," 頁"]})]})]}),s&&"complete"!==t.status&&"error"!==t.status&&(0,a.jsxs)("button",{onClick:s,className:"group flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-red-600 hover:bg-gradient-to-r hover:from-red-50 hover:to-pink-50 rounded-xl border border-gray-200 hover:border-red-300 transition-all duration-300 font-medium",title:"取消下載",children:[(0,a.jsx)(f.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"取消"})]})]}),t.totalPages>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-full bg-gradient-to-r from-gray-200 to-gray-300 rounded-2xl h-4 shadow-inner",children:(0,a.jsx)("div",{className:"h-4 rounded-2xl transition-all duration-500 ease-out relative overflow-hidden ".concat("complete"===t.status?"bg-gradient-to-r from-green-500 to-emerald-600":"error"===t.status?"bg-gradient-to-r from-red-500 to-pink-600":"bg-gradient-to-r from-blue-500 via-purple-600 to-indigo-600"),style:{width:"".concat(r(),"%")},children:"complete"!==t.status&&"error"!==t.status&&(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-pulse"})})}),(0,a.jsx)("div",{className:"absolute -top-8 left-0 right-0 flex justify-center",children:(0,a.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-bold shadow-sm ".concat("complete"===t.status?"bg-green-100 text-green-700":"error"===t.status?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"),children:[r(),"% 完成"]})})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full animate-pulse ".concat("complete"===t.status?"bg-green-500":"error"===t.status?"bg-red-500":"bg-blue-500")}),(0,a.jsx)("span",{className:"font-medium",children:"complete"===t.status?"完成":"error"===t.status?"失敗":"處理中"})]}),t.estimatedTimeRemaining&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-xs",children:"⏱️"}),(0,a.jsxs)("span",{className:"font-medium",children:["預估剩餘: ",t.estimatedTimeRemaining,"秒"]})]})]})]})]}),"error"===t.status&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-red-50 via-pink-50 to-red-50 border-2 border-red-200 rounded-2xl p-6 shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-red-500 to-pink-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"❌"})}),(0,a.jsx)("h4",{className:"text-lg font-bold text-red-800",children:"下載失敗"})]}),(0,a.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-red-100",children:[(0,a.jsx)("div",{className:"text-red-700 font-medium",children:"請檢查網路連線或 Canva 連結是否有效，然後重試。"}),(0,a.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,a.jsx)("span",{className:"text-xs bg-red-100 text-red-700 px-3 py-1 rounded-full font-medium",children:"\uD83D\uDD17 檢查連結"}),(0,a.jsx)("span",{className:"text-xs bg-red-100 text-red-700 px-3 py-1 rounded-full font-medium",children:"\uD83C\uDF10 檢查網路"})]})]})]}),"complete"===t.status&&(0,a.jsxs)("div",{className:"bg-gradient-to-r from-green-50 via-emerald-50 to-green-50 border-2 border-green-200 rounded-2xl p-6 shadow-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm",children:"✅"})}),(0,a.jsx)("h4",{className:"text-lg font-bold text-green-800",children:"下載完成"})]}),(0,a.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-xl p-4 border border-green-100",children:[(0,a.jsx)("div",{className:"text-green-700 font-medium mb-3",children:"\uD83C\uDF89 檔案已成功儲存到您的下載資料夾！"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-3 py-1 rounded-full font-medium",children:"\uD83D\uDCC1 查看檔案"}),(0,a.jsx)("span",{className:"text-xs bg-green-100 text-green-700 px-3 py-1 rounded-full font-medium",children:"\uD83D\uDD04 再次下載"})]})]})]})]})}var v=s(4020),w=s(4357),N=s(3786),y=s(2525),k=s(5448),C=s(5880),D=s(9074);function A(e){let{history:t,onRedownload:s,onDelete:n}=e,[d,c]=(0,r.useState)(null),[x,m]=(0,r.useState)(null),u=async(e,t)=>{try{await navigator.clipboard.writeText(e),m(t),setTimeout(()=>m(null),2e3)}catch(e){console.error("Failed to copy URL:",e)}};return 0===t.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:(0,a.jsx)(l.A,{className:"w-10 h-10 text-blue-500"})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"尚無下載記錄"}),(0,a.jsx)("p",{className:"text-gray-600",children:"開始下載 Canva 簡報後，記錄會顯示在這裡"}),(0,a.jsx)("div",{className:"mt-6 text-xs text-blue-600 bg-blue-50 rounded-lg px-4 py-2 inline-block",children:"\uD83D\uDCA1 小貼士：每次下載都會自動記錄，方便您管理"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["共 ",(0,a.jsx)("span",{className:"font-bold text-blue-600",children:t.length})," 筆下載記錄"]})}),(0,a.jsx)("div",{className:"space-y-3",children:t.map(e=>{let t;return(0,a.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md hover:border-blue-300 transition-all",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 rounded-lg flex-shrink-0",children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-blue-600"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 truncate mt-1",children:e.url})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>c(d===e.id?null:e.id),className:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-100 rounded transition-colors",children:(0,a.jsx)(v.A,{className:"w-4 h-4"})}),d===e.id&&(0,a.jsxs)("div",{className:"absolute right-0 top-8 z-20 bg-white border border-gray-200 rounded-lg shadow-lg py-1 min-w-[140px]",children:[(0,a.jsxs)("button",{onClick:()=>{s(e),c(null)},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-700 w-full text-left transition-colors",children:[(0,a.jsx)(l.A,{className:"w-4 h-4"}),"重新下載"]}),(0,a.jsx)("button",{onClick:()=>{u(e.url,e.id),c(null)},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left",children:x===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{className:"w-4 h-4 text-green-600"}),"已複製"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.A,{className:"w-4 h-4"}),"複製連結"]})}),(0,a.jsxs)("button",{onClick:()=>{var t;t=e.url,window.open(t,"_blank","noopener,noreferrer"),c(null)},className:"flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 w-full text-left",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),"開啟原檔"]}),(0,a.jsx)("hr",{className:"my-1"}),(0,a.jsxs)("button",{onClick:()=>{n(e.id),c(null)},className:"flex items-center gap-2 px-3 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[(0,a.jsx)(y.A,{className:"w-4 h-4"}),"刪除記錄"]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(k.A,{className:"w-3 h-3"}),(0,a.jsxs)("span",{children:[e.pageCount," 頁"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(C.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:(e=>{if(0===e)return"0 B";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]})(e.fileSize)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(D.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:(t=e.downloadedAt,new Intl.DateTimeFormat("zh-TW",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(t)))})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("ultra"===e.options.quality?"bg-purple-100 text-purple-800":"high"===e.options.quality?"bg-blue-100 text-blue-800":"medium"===e.options.quality?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:"ultra"===e.options.quality?"超高品質":"high"===e.options.quality?"高品質":"medium"===e.options.quality?"中品質":"低品質"}),(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"pdf"===e.options.format?"PDF":"圖片"})]})]})]})},e.id)})}),d&&(0,a.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>c(null)})]})}var S=s(8693),P=s(6786);let q={defaultQuality:"high",defaultFormat:"pdf",autoOpenPdf:!0,showPreview:!0,maxConcurrentDownloads:3},F=(0,S.vt)()((0,P.Zr)((e,t)=>({jobs:new Map,history:[],preferences:q,addJob:(t,s)=>{let a="job_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),r={id:a,url:t,options:s,progress:{status:"idle",currentPage:0,totalPages:0,percentage:0,message:"準備開始下載..."},createdAt:new Date};return e(e=>({jobs:new Map(e.jobs.set(a,r))})),a},updateJobProgress:(s,a)=>{let r=t().jobs.get(s);if(r){let t={...r,progress:a,startedAt:r.startedAt||new Date};e(e=>({jobs:new Map(e.jobs.set(s,t))}))}},completeJob:(s,a)=>{let r=t().jobs.get(s);if(r){let t={...r,result:a,completedAt:new Date,progress:{...r.progress,status:a.success?"complete":"error",percentage:100,message:a.success?"下載完成！":a.error||"下載失敗"}};if(a.success&&a.pageCount&&a.fileSize){let l={id:"history_".concat(Date.now()),url:r.url,title:"Canva Slides ".concat(new Date().toLocaleDateString()),pageCount:a.pageCount,fileSize:a.fileSize,downloadedAt:new Date,options:r.options};e(e=>({jobs:new Map(e.jobs.set(s,t)),history:[l,...e.history.slice(0,49)]}))}else e(e=>({jobs:new Map(e.jobs.set(s,t))}))}},cancelJob:s=>{let a=t().jobs.get(s);if(a){let t={...a,completedAt:new Date,progress:{...a.progress,status:"error",message:"下載已取消"}};e(e=>({jobs:new Map(e.jobs.set(s,t))}))}},addToHistory:t=>{e(e=>({history:[t,...e.history.slice(0,49)]}))},updatePreferences:t=>{e(e=>({preferences:{...e.preferences,...t}}))},clearHistory:()=>{e({history:[]})}}),{name:"canva-downloader-store",partialize:e=>({history:e.history,preferences:e.preferences}),version:1}));function M(){let[e,t]=(0,r.useState)(""),[n,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)("download"),{jobs:m,history:u,preferences:h,addJob:g,updatePreferences:p}=F(),[f,v]=(0,r.useState)({quality:h.defaultQuality,format:h.defaultFormat,includeMetadata:!0,compression:85}),w=async e=>{t(e),d(!0);try{let t=g(e,f),a=window.location.pathname.includes("/canva-slide-download")?"/canva-slide-download":"";try{let s=await fetch("".concat(a,"/api/download"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e,options:f,jobId:t})});if(s.ok){let e=await s.blob(),t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="canva-slides-".concat(Date.now(),".").concat("pdf"===f.format?"pdf":"zip"),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(t)}else throw Error("API not available")}catch(r){let{downloadCanvaSlides:t}=await s.e(272).then(s.bind(s,8272)),a=await t(e,f);if(!a.success)throw Error(a.error||"Download functionality requires server deployment")}}catch(e){console.error("Download error:",e)}finally{d(!1)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100",children:[(0,a.jsxs)("header",{className:"relative overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 opacity-90"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg%20width=%2260%22%20height=%2260%22%20viewBox=%220%200%2060%2060%22%20xmlns=%22http://www.w3.org/2000/svg%22%3E%3Cg%20fill=%22none%22%20fill-rule=%22evenodd%22%3E%3Cg%20fill=%22%23ffffff%22%20fill-opacity=%220.1%22%3E%3Ccircle%20cx=%227%22%20cy=%227%22%20r=%227%22/%3E%3C/g%3E%3C/g%3E%3C/svg%3E')] opacity-20"}),(0,a.jsx)("div",{className:"relative container mx-auto px-4 py-12",children:(0,a.jsxs)("div",{className:"text-center text-white",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white/20 backdrop-blur-sm rounded-3xl mb-6",children:(0,a.jsx)(l.A,{className:"w-10 h-10 text-white"})}),(0,a.jsx)("h1",{className:"text-5xl font-bold mb-4 bg-gradient-to-r from-white to-blue-100 bg-clip-text text-transparent",children:"Canva Slide Downloader"}),(0,a.jsx)("p",{className:"text-xl text-blue-100 mb-6 max-w-2xl mx-auto",children:"將您的 Canva 簡報輕鬆轉換為高品質 PDF 或圖片檔案"}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full text-sm text-blue-100",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),"GitHub Pages 最新版本 - 美觀現代化設計"]})]})})]}),(0,a.jsxs)("main",{className:"container mx-auto px-4 -mt-6 relative z-10",children:[(0,a.jsx)("div",{className:"flex justify-center mb-12",children:(0,a.jsx)("div",{className:"bg-white/70 backdrop-blur-md p-2 rounded-2xl shadow-lg border border-white/20",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>c("download"),className:"flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-300 ".concat("download"===o?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg transform scale-105":"text-gray-700 hover:bg-white/50"),children:[(0,a.jsx)(l.A,{className:"w-4 h-4"}),"下載工具"]}),(0,a.jsxs)("button",{onClick:()=>c("history"),className:"flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all duration-300 ".concat("history"===o?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg transform scale-105":"text-gray-700 hover:bg-white/50"),children:[(0,a.jsx)(i.A,{className:"w-4 h-4"}),"下載記錄"]})]})})}),"download"===o?(0,a.jsxs)("div",{className:"max-w-5xl mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl border border-white/20 p-8 shadow-2xl hover:shadow-3xl transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-2xl flex items-center justify-center text-lg font-bold shadow-lg",children:"1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"輸入 Canva 簡報連結"}),(0,a.jsx)("p",{className:"text-gray-600",children:"貼上您的 Canva 設計連結，我們將為您分析"})]})]}),(0,a.jsx)(x,{onUrlSubmit:w,isLoading:n})]}),(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl border border-white/20 p-8 shadow-2xl hover:shadow-3xl transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-2xl flex items-center justify-center text-lg font-bold shadow-lg",children:"2"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"選擇下載設定"}),(0,a.jsx)("p",{className:"text-gray-600",children:"自訂品質、格式和其他選項"})]})]}),(0,a.jsx)(b,{options:f,onChange:v,disabled:n})]}),n&&(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl border border-white/20 p-8 shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-teal-600 text-white rounded-2xl flex items-center justify-center text-lg font-bold shadow-lg",children:"3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"下載進度"}),(0,a.jsx)("p",{className:"text-gray-600",children:"正在處理您的簡報"})]})]}),(0,a.jsx)(j,{progress:{status:"parsing",currentPage:0,totalPages:0,percentage:0,message:"正在解析 Canva 連結..."},onCancel:()=>d(!1)})]})]}):(0,a.jsx)("div",{className:"max-w-5xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-md rounded-3xl border border-white/20 p-8 shadow-2xl",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-2xl flex items-center justify-center shadow-lg",children:(0,a.jsx)(i.A,{className:"w-6 h-6"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-1",children:"下載記錄"}),(0,a.jsx)("p",{className:"text-gray-600",children:"查看您的下載歷史和重新下載"})]})]}),(0,a.jsx)(A,{history:u,onRedownload:e=>{c("download"),w(e.url)},onDelete:e=>{}})]})})]}),(0,a.jsx)("footer",{className:"mt-20 py-8 text-center text-gray-600",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsx)("p",{className:"text-sm",children:"Built with ❤️ using Next.js, TypeScript & Tailwind CSS"}),(0,a.jsxs)("p",{className:"text-xs mt-2 opacity-70",children:["\uD83E\uDD16 Generated with ",(0,a.jsx)("a",{href:"https://claude.ai/code",className:"underline hover:text-blue-600",children:"Claude Code"})]})]})})]})}},6811:(e,t,s)=>{Promise.resolve().then(s.bind(s,5782))}},e=>{e.O(0,[190,441,964,358],()=>e(e.s=6811)),_N_E=e.O()}]);